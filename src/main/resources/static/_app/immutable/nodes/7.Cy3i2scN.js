import{s as D,n as C,c as $,o as j}from"../chunks/scheduler.Dw9uJjIS.js";import{S as x,i as O,e as g,s as S,c as v,h as w,a as U,f as h,g as P,b as c,d as T,k as m,m as R}from"../chunks/index.LMNcmw-L.js";import{w as B}from"../chunks/index.CdM32__g.js";function L(d){let t;return{c(){t=g("object"),this.h()},l(n){t=v(n,"OBJECT",{data:!0,type:!0,width:!0,height:!0}),w(t).forEach(h),this.h()},h(){c(t,"data",d[0]),c(t,"type","application/pdf"),c(t,"width","100%"),c(t,"height","500px")},m(n,s){T(n,t,s)},p(n,s){s&1&&c(t,"data",n[0])},d(n){n&&h(t)}}}function I(d){let t,n,s,f,e,i="Save Signature",p,u,a=d[0]&&L(d);return{c(){t=g("div"),a&&a.c(),n=S(),s=g("canvas"),f=S(),e=g("button"),e.textContent=i,this.h()},l(o){t=v(o,"DIV",{class:!0});var r=w(t);a&&a.l(r),n=U(r),s=v(r,"CANVAS",{id:!0,width:!0,height:!0,class:!0}),w(s).forEach(h),f=U(r),e=v(r,"BUTTON",{"data-svelte-h":!0}),P(e)!=="svelte-ljxtgg"&&(e.textContent=i),r.forEach(h),this.h()},h(){c(s,"id","signatureCanvas"),c(s,"width","600"),c(s,"height","300"),c(s,"class","svelte-156dcdv"),c(t,"class","container")},m(o,r){T(o,t,r),a&&a.m(t,null),m(t,n),m(t,s),m(t,f),m(t,e),p||(u=R(e,"click",d[2]),p=!0)},p(o,[r]){o[0]?a?a.p(o,r):(a=L(o),a.c(),a.m(t,n)):a&&(a.d(1),a=null)},i:C,o:C,d(o){o&&h(t),a&&a.d(),p=!1,u()}}}const k="http://localhost:8080";function N(d,t,n){let s,f=B("");$(d,f,l=>n(0,s=l));let e,i,u=new URLSearchParams(window.location.search).get("id");j(async()=>{if(u){const l=await fetch(`${k}/signature/${u}`);if(l.ok){const b=await l.blob(),y=URL.createObjectURL(b);f.set(y)}else console.error("Failed to load the document.");a()}else console.error("Document ID is missing in the URL parameters.")});const a=()=>{e=document.getElementById("signatureCanvas"),i=e.getContext("2d"),e.addEventListener("mousedown",r),e.addEventListener("mouseup",E),e.addEventListener("mousemove",_)};let o=!1;const r=l=>{o=!0,_(l)},E=()=>{o=!1,i.beginPath()},_=l=>{o&&(i.lineWidth=2,i.lineCap="round",i.strokeStyle="black",i.lineTo(l.clientX-e.offsetLeft,l.clientY-e.offsetTop),i.stroke(),i.beginPath(),i.moveTo(l.clientX-e.offsetLeft,l.clientY-e.offsetTop))};return[s,f,async()=>{const b={signatureDataUrl:e.toDataURL("image/png")};(await fetch(`${k}/signature/${u}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok?alert("Signature saved successfully!"):alert("Failed to save signature.")}]}class X extends x{constructor(t){super(),O(this,t,N,I,D,{})}}export{X as component};
