import{s as j,n as y,c as $,o as D}from"../chunks/scheduler.Cu15T-2q.js";import{S as x,i as O,e as g,s as C,c as v,h as b,a as S,f as h,g as P,b as c,d as T,j as m,l as R}from"../chunks/index.Cx9YqTjb.js";import{w as B}from"../chunks/index.BQQFQYTz.js";function L(d){let e;return{c(){e=g("object"),this.h()},l(n){e=v(n,"OBJECT",{data:!0,type:!0,width:!0,height:!0}),b(e).forEach(h),this.h()},h(){c(e,"data",d[0]),c(e,"type","application/pdf"),c(e,"width","100%"),c(e,"height","500px")},m(n,s){T(n,e,s)},p(n,s){s&1&&c(e,"data",n[0])},d(n){n&&h(e)}}}function I(d){let e,n,s,f,t,r="Save Signature",p,u,a=d[0]&&L(d);return{c(){e=g("div"),a&&a.c(),n=C(),s=g("canvas"),f=C(),t=g("button"),t.textContent=r,this.h()},l(o){e=v(o,"DIV",{class:!0});var l=b(e);a&&a.l(l),n=S(l),s=v(l,"CANVAS",{id:!0,width:!0,height:!0,class:!0}),b(s).forEach(h),f=S(l),t=v(l,"BUTTON",{"data-svelte-h":!0}),P(t)!=="svelte-ljxtgg"&&(t.textContent=r),l.forEach(h),this.h()},h(){c(s,"id","signatureCanvas"),c(s,"width","600"),c(s,"height","300"),c(s,"class","svelte-156dcdv"),c(e,"class","container")},m(o,l){T(o,e,l),a&&a.m(e,null),m(e,n),m(e,s),m(e,f),m(e,t),p||(u=R(t,"click",d[2]),p=!0)},p(o,[l]){o[0]?a?a.p(o,l):(a=L(o),a.c(),a.m(e,n)):a&&(a.d(1),a=null)},i:y,o:y,d(o){o&&h(e),a&&a.d(),p=!1,u()}}}const U="http://localhost:8080";function N(d,e,n){let s,f=B("");$(d,f,i=>n(0,s=i));let t,r,u=new URLSearchParams(window.location.search).get("id");D(async()=>{if(u){const i=await fetch(`${U}/signature/${u}`);if(i.ok){const _=await i.blob(),E=URL.createObjectURL(_);f.set(E)}else console.error("Failed to load the document.");a()}else console.error("Document ID is missing in the URL parameters.")});const a=()=>{t=document.getElementById("signatureCanvas"),r=t.getContext("2d"),t.addEventListener("mousedown",l),t.addEventListener("mouseup",k),t.addEventListener("mousemove",w)};let o=!1;const l=i=>{o=!0,w(i)},k=()=>{o=!1,r.beginPath()},w=i=>{o&&(r.lineWidth=2,r.lineCap="round",r.strokeStyle="black",r.lineTo(i.clientX-t.offsetLeft,i.clientY-t.offsetTop),r.stroke(),r.beginPath(),r.moveTo(i.clientX-t.offsetLeft,i.clientY-t.offsetTop))};return[s,f,async()=>{const i=t.toDataURL("image/png");(await fetch(`${U}/signature/${u}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok?alert("Signature saved successfully!"):alert("Failed to save signature.")}]}class X extends x{constructor(e){super(),O(this,e,N,I,j,{})}}export{X as component};
