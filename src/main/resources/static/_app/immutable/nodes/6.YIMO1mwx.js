import{s as j,n as C,c as D,o as $}from"../chunks/scheduler.Dl-qE2gW.js";import{S as x,i as O,e as g,s as S,c as v,h as w,a as U,f as p,g as P,b as c,d as k,j as m,l as R}from"../chunks/index.DsPxIqaf.js";import{w as B}from"../chunks/index.9Rd9P6Ws.js";function L(d){let e;return{c(){e=g("object"),this.h()},l(n){e=v(n,"OBJECT",{data:!0,type:!0,width:!0,height:!0}),w(e).forEach(p),this.h()},h(){c(e,"data",d[0]),c(e,"type","application/pdf"),c(e,"width","100%"),c(e,"height","500px")},m(n,s){k(n,e,s)},p(n,s){s&1&&c(e,"data",n[0])},d(n){n&&p(e)}}}function I(d){let e,n,s,f,t,o="Save Signature",h,u,a=d[0]&&L(d);return{c(){e=g("div"),a&&a.c(),n=S(),s=g("canvas"),f=S(),t=g("button"),t.textContent=o,this.h()},l(i){e=v(i,"DIV",{class:!0});var r=w(e);a&&a.l(r),n=U(r),s=v(r,"CANVAS",{id:!0,width:!0,height:!0,class:!0}),w(s).forEach(p),f=U(r),t=v(r,"BUTTON",{"data-svelte-h":!0}),P(t)!=="svelte-ljxtgg"&&(t.textContent=o),r.forEach(p),this.h()},h(){c(s,"id","signatureCanvas"),c(s,"width","600"),c(s,"height","300"),c(s,"class","svelte-156dcdv"),c(e,"class","container")},m(i,r){k(i,e,r),a&&a.m(e,null),m(e,n),m(e,s),m(e,f),m(e,t),h||(u=R(t,"click",d[2]),h=!0)},p(i,[r]){i[0]?a?a.p(i,r):(a=L(i),a.c(),a.m(e,n)):a&&(a.d(1),a=null)},i:C,o:C,d(i){i&&p(e),a&&a.d(),h=!1,u()}}}const T="https://policysign.azurewebsites.net";function N(d,e,n){let s,f=B("");D(d,f,l=>n(0,s=l));let t,o,u=new URLSearchParams(window.location.search).get("id");$(async()=>{if(u){const l=await fetch(`${T}/signature/${u}`);if(l.ok){const b=await l.blob(),y=URL.createObjectURL(b);f.set(y)}else console.error("Failed to load the document.");a()}else console.error("Document ID is missing in the URL parameters.")});const a=()=>{t=document.getElementById("signatureCanvas"),o=t.getContext("2d"),t.addEventListener("mousedown",r),t.addEventListener("mouseup",E),t.addEventListener("mousemove",_)};let i=!1;const r=l=>{i=!0,_(l)},E=()=>{i=!1,o.beginPath()},_=l=>{i&&(o.lineWidth=2,o.lineCap="round",o.strokeStyle="black",o.lineTo(l.clientX-t.offsetLeft,l.clientY-t.offsetTop),o.stroke(),o.beginPath(),o.moveTo(l.clientX-t.offsetLeft,l.clientY-t.offsetTop))};return[s,f,async()=>{const b={signatureDataUrl:t.toDataURL("image/png")};(await fetch(`${T}/signature/${u}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok?alert("Signature saved successfully!"):alert("Failed to save signature.")}]}class X extends x{constructor(e){super(),O(this,e,N,I,j,{})}}export{X as component};
