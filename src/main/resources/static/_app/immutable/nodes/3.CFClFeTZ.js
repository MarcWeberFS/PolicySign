import{s as He,n as Ne,o as Le,g as Ue}from"../chunks/scheduler.Dl-qE2gW.js";import{S as Fe,i as qe,e as n,s as b,t as z,c as r,g as Z,a as C,h as f,m as B,f as o,b as i,d as L,j as e,n as O,o as Me,l as Oe}from"../chunks/index.DsPxIqaf.js";import{e as ye}from"../chunks/each.D6YF6ztN.js";import{j as Je,u as Ke}from"../chunks/auth.service.i91Jw0BU.js";function ze(s,c,a){const d=s.slice();return d[10]=c[a],d}function Be(s){let c,a;return{c(){c=n("p"),a=z(s[4]),this.h()},l(d){c=r(d,"P",{class:!0});var h=f(c);a=B(h,s[4]),h.forEach(o),this.h()},h(){i(c,"class","text-red-500 text-center")},m(d,h){L(d,c,h),e(c,a)},p(d,h){h&16&&O(a,d[4])},d(d){d&&o(c)}}}function Te(s){let c,a,d,h,w=s[10].title+"",D,m,V,U,v,x,g,l,F="UserID:",T,G=s[10].userId+"",P,$,N,j,I,E="Signed by:",H,p=s[10].signedByEmail+"",t,_,u,A,q=s[10].status+"",Q,J,ee,M,y,R,De="Created on:",fe,oe=new Date(s[10].creationDate).toLocaleDateString()+"",ne,ve,te,W,X,we="Last updated:",pe,ae=new Date(s[10].updateDate).toLocaleDateString()+"",re,_e,se,K,be="Delete",me,Ee,Ce;function Ge(){return s[6](s[10])}return{c(){c=n("div"),a=n("div"),d=n("h2"),h=n("a"),D=z(w),U=b(),v=n("div"),x=n("div"),g=n("p"),l=n("span"),l.textContent=F,T=b(),P=z(G),$=b(),N=n("div"),j=n("p"),I=n("span"),I.textContent=E,H=b(),t=z(p),_=b(),u=n("div"),A=n("p"),Q=z(q),ee=b(),M=n("div"),y=n("p"),R=n("span"),R.textContent=De,fe=b(),ne=z(oe),ve=b(),te=n("div"),W=n("p"),X=n("span"),X.textContent=we,pe=b(),re=z(ae),_e=b(),se=n("div"),K=n("button"),K.textContent=be,me=b(),this.h()},l(Y){c=r(Y,"DIV",{class:!0});var k=f(c);a=r(k,"DIV",{class:!0});var ce=f(a);d=r(ce,"H2",{class:!0});var ge=f(d);h=r(ge,"A",{href:!0,download:!0});var je=f(h);D=B(je,w),je.forEach(o),ge.forEach(o),U=C(ce),v=r(ce,"DIV",{class:!0});var S=f(v);x=r(S,"DIV",{class:!0});var Ie=f(x);g=r(Ie,"P",{});var ie=f(g);l=r(ie,"SPAN",{class:!0,"data-svelte-h":!0}),Z(l)!=="svelte-al04wj"&&(l.textContent=F),T=C(ie),P=B(ie,G),ie.forEach(o),Ie.forEach(o),$=C(S),N=r(S,"DIV",{class:!0});var ke=f(N);j=r(ke,"P",{});var de=f(j);I=r(de,"SPAN",{class:!0,"data-svelte-h":!0}),Z(I)!=="svelte-13c10p6"&&(I.textContent=E),H=C(de),t=B(de,p),de.forEach(o),ke.forEach(o),_=C(S),u=r(S,"DIV",{class:!0});var Ve=f(u);A=r(Ve,"P",{class:!0});var xe=f(A);Q=B(xe,q),xe.forEach(o),Ve.forEach(o),ee=C(S),M=r(S,"DIV",{class:!0});var Pe=f(M);y=r(Pe,"P",{});var ue=f(y);R=r(ue,"SPAN",{class:!0,"data-svelte-h":!0}),Z(R)!=="svelte-1qy30zs"&&(R.textContent=De),fe=C(ue),ne=B(ue,oe),ue.forEach(o),Pe.forEach(o),ve=C(S),te=r(S,"DIV",{class:!0});var Ae=f(te);W=r(Ae,"P",{});var he=f(W);X=r(he,"SPAN",{class:!0,"data-svelte-h":!0}),Z(X)!=="svelte-1hton06"&&(X.textContent=we),pe=C(he),re=B(he,ae),he.forEach(o),Ae.forEach(o),_e=C(S),se=r(S,"DIV",{class:!0});var Se=f(se);K=r(Se,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(K)!=="svelte-18bkf1z"&&(K.textContent=be),Se.forEach(o),S.forEach(o),ce.forEach(o),me=C(k),k.forEach(o),this.h()},h(){i(h,"href",m=`${le}/api/upload/download/${s[10].id}?token=${s[0]}`),i(h,"download",V=s[10].title+".pdf"),i(d,"class","text-xl font-bold mb-2"),i(l,"class","label svelte-1jop7nh"),i(x,"class","svelte-1jop7nh"),i(I,"class","label svelte-1jop7nh"),i(N,"class","svelte-1jop7nh"),i(A,"class",J="status-label "+(s[10].status==="PENDING"?"status-pending":"status-signed")+" svelte-1jop7nh"),i(u,"class","svelte-1jop7nh"),i(R,"class","label svelte-1jop7nh"),i(M,"class","svelte-1jop7nh"),i(X,"class","label svelte-1jop7nh"),i(te,"class","svelte-1jop7nh"),i(K,"class","delete-button svelte-1jop7nh"),i(se,"class","svelte-1jop7nh"),i(v,"class","document-details svelte-1jop7nh"),i(a,"class","bg-white shadow-md rounded-lg p-6"),i(c,"class","document-card w-full p-4 svelte-1jop7nh")},m(Y,k){L(Y,c,k),e(c,a),e(a,d),e(d,h),e(h,D),e(a,U),e(a,v),e(v,x),e(x,g),e(g,l),e(g,T),e(g,P),e(v,$),e(v,N),e(N,j),e(j,I),e(j,H),e(j,t),e(v,_),e(v,u),e(u,A),e(A,Q),e(v,ee),e(v,M),e(M,y),e(y,R),e(y,fe),e(y,ne),e(v,ve),e(v,te),e(te,W),e(W,X),e(W,pe),e(W,re),e(v,_e),e(v,se),e(se,K),e(c,me),Ee||(Ce=Oe(K,"click",Ge),Ee=!0)},p(Y,k){s=Y,k&8&&w!==(w=s[10].title+"")&&O(D,w),k&9&&m!==(m=`${le}/api/upload/download/${s[10].id}?token=${s[0]}`)&&i(h,"href",m),k&8&&V!==(V=s[10].title+".pdf")&&i(h,"download",V),k&8&&G!==(G=s[10].userId+"")&&O(P,G),k&8&&p!==(p=s[10].signedByEmail+"")&&O(t,p),k&8&&q!==(q=s[10].status+"")&&O(Q,q),k&8&&J!==(J="status-label "+(s[10].status==="PENDING"?"status-pending":"status-signed")+" svelte-1jop7nh")&&i(A,"class",J),k&8&&oe!==(oe=new Date(s[10].creationDate).toLocaleDateString()+"")&&O(ne,oe),k&8&&ae!==(ae=new Date(s[10].updateDate).toLocaleDateString()+"")&&O(re,ae)},d(Y){Y&&o(c),Ee=!1,Ce()}}}function Qe(s){let c,a="Admin Dashboard",d,h,w,D,m,V,U,v,x,g,l,F,T,G,P,$="All Documents",N,j,I,E=s[4]&&Be(s),H=ye(s[3]),p=[];for(let t=0;t<H.length;t+=1)p[t]=Te(ze(s,H,t));return{c(){c=n("h1"),c.textContent=a,d=b(),E&&E.c(),h=b(),w=n("div"),D=n("div"),m=n("div"),V=n("h2"),U=z("User Count: "),v=z(s[1]),x=b(),g=n("div"),l=n("h2"),F=z("Document Count: "),T=z(s[2]),G=b(),P=n("h2"),P.textContent=$,N=b(),j=n("div"),I=n("div");for(let t=0;t<p.length;t+=1)p[t].c();this.h()},l(t){c=r(t,"H1",{class:!0,"data-svelte-h":!0}),Z(c)!=="svelte-1tioth5"&&(c.textContent=a),d=C(t),E&&E.l(t),h=C(t),w=r(t,"DIV",{class:!0});var _=f(w);D=r(_,"DIV",{class:!0});var u=f(D);m=r(u,"DIV",{});var A=f(m);V=r(A,"H2",{class:!0});var q=f(V);U=B(q,"User Count: "),v=B(q,s[1]),q.forEach(o),A.forEach(o),x=C(u),g=r(u,"DIV",{});var Q=f(g);l=r(Q,"H2",{class:!0});var J=f(l);F=B(J,"Document Count: "),T=B(J,s[2]),J.forEach(o),Q.forEach(o),u.forEach(o),_.forEach(o),G=C(t),P=r(t,"H2",{class:!0,"data-svelte-h":!0}),Z(P)!=="svelte-1c01uka"&&(P.textContent=$),N=C(t),j=r(t,"DIV",{class:!0});var ee=f(j);I=r(ee,"DIV",{class:!0});var M=f(I);for(let y=0;y<p.length;y+=1)p[y].l(M);M.forEach(o),ee.forEach(o),this.h()},h(){i(c,"class","text-3xl font-bold text-center mb-6"),i(V,"class","text-2xl font-bold"),i(l,"class","text-2xl font-bold"),i(D,"class","flex justify-between"),i(w,"class","container mx-auto px-4 mb-6"),i(P,"class","text-2xl font-bold mb-4 mt-4 text-center"),i(I,"class","flex flex-wrap -mx-4"),i(j,"class","container mx-auto px-4")},m(t,_){L(t,c,_),L(t,d,_),E&&E.m(t,_),L(t,h,_),L(t,w,_),e(w,D),e(D,m),e(m,V),e(V,U),e(V,v),e(D,x),e(D,g),e(g,l),e(l,F),e(l,T),L(t,G,_),L(t,P,_),L(t,N,_),L(t,j,_),e(j,I);for(let u=0;u<p.length;u+=1)p[u]&&p[u].m(I,null)},p(t,[_]){if(t[4]?E?E.p(t,_):(E=Be(t),E.c(),E.m(h.parentNode,h)):E&&(E.d(1),E=null),_&2&&O(v,t[1]),_&4&&O(T,t[2]),_&41){H=ye(t[3]);let u;for(u=0;u<H.length;u+=1){const A=ze(t,H,u);p[u]?p[u].p(A,_):(p[u]=Te(A),p[u].c(),p[u].m(I,null))}for(;u<p.length;u+=1)p[u].d(1);p.length=H.length}},i:Ne,o:Ne,d(t){t&&(o(c),o(d),o(h),o(w),o(G),o(P),o(N),o(j)),E&&E.d(t),Me(p,t)}}}const le="https://policysign.azurewebsites.net";function Re(s,c,a){let d;Je.subscribe(l=>{a(0,d=l)});let h=0,w=0,D=[],m="";Le(async()=>{await V(),await U(),await v()});async function V(){try{const l=await fetch(`${le}/api/users/count`,{method:"GET",headers:{Authorization:`Bearer ${d}`}});l.ok?a(1,h=await l.json()):a(4,m="Failed to fetch user count")}catch(l){console.error("Error fetching user count:",l),a(4,m="Error fetching user count")}}async function U(){try{const l=await fetch(`${le}/api/upload/count`,{method:"GET",headers:{Authorization:`Bearer ${d}`}});l.ok?a(2,w=await l.json()):a(4,m="Failed to fetch document count")}catch(l){console.error("Error fetching document count:",l),a(4,m="Error fetching document count")}}async function v(){try{const l=await fetch(`${le}/api/upload/all`,{method:"GET",headers:{Authorization:`Bearer ${d}`}});l.ok?a(3,D=await l.json()):a(4,m="Failed to fetch documents")}catch(l){console.error("Error fetching documents:",l),a(4,m="Error fetching documents")}}async function x(l){try{(await fetch(`${le}/api/upload/delete/${l}`,{method:"POST",headers:{Authorization:`Bearer ${d}`}})).ok?(a(3,D=D.filter(T=>T.id!==l)),window.location.reload()):a(4,m="Failed to delete document")}catch(F){console.error("Error deleting document:",F),a(4,m="Error deleting document")}}const g=l=>x(l.id);return Ue(Ke)||(window.location.href="/login"),[d,h,w,D,m,x,g]}class $e extends Fe{constructor(c){super(),qe(this,c,Re,Qe,He,{})}}export{$e as component};
